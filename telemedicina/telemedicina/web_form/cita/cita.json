{
 "accept_payment": 0,
 "allow_comments": 0,
 "allow_delete": 0,
 "allow_edit": 1,
 "allow_incomplete": 0,
 "allow_multiple": 1,
 "allow_print": 0,
 "amount": 0.0,
 "amount_based_on_field": 0,
 "button_label": "Save",
 "client_script": "$('.control-input[style=\"display: none;\"]').parent().parent().hide();\r\n$('div[data-fieldname=\"patient\"]').hide();\r\n$('div[data-fieldname=\"duration\"]').hide();\r\n$('div[data-fieldname=\"mode_of_payment\"]').hide();\r\n$('div[data-fieldname=\"paid_amount\"]').hide();\r\n$('div[data-fieldname=\"appointment_datetime\"]').hide();\r\nvar last_doc = frappe.web_form.doc;\r\n\r\n\r\nfrappe.web_form.set_value(\"mode_of_payment\",\"Tarjeta de Cr\u00e9dito\");\r\nfrappe.call({method:\"telemedicina.api.get_patient\", args:{user_id:frappe.user_id}, callback:function(r){\r\n    if(r.message !== undefined){\r\n        localStorage.setItem(\"patient-\"+frappe.user_id,r.message.name);\r\n        frappe.web_form.fields_dict.patient.set_value(r.message.name);\r\n        frappe.web_form.set_df_property(\"patient\",\"read_only\",1);\r\n    }\r\n} });\r\nfrappe.web_form.on(\"appointment_date\", function() {\r\n    if(frappe.web_form.doc.appointment_time !== undefined){\r\n        if(frappe.web_form.doc.appointment_time != \"\"){\r\n            frappe.web_form.set_value(\"appointment_datetime\",frappe.web_form.doc.appointment_date+\" \"+frappe.web_form.doc.appointment_time);\r\n        }\r\n    }\r\n});\r\nfrappe.web_form.on(\"appointment_time\", function() {\r\n    if(frappe.web_form.doc.appointment_date !== undefined){\r\n        if(frappe.web_form.doc.appointment_date != \"\"){\r\n            frappe.web_form.set_value(\"appointment_datetime\",frappe.web_form.doc.appointment_date+\" \"+frappe.web_form.doc.appointment_time);\r\n        }\r\n    }\r\n});\r\nfrappe.web_form.on(\"practitioner\", function() {\t\t\r\n    if(frappe.web_form.doc.practitioner === undefined){return};\r\n    $('select[data-fieldname=\"appointment_time\"]').html('');\r\n    var daysOfWeek=[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\",\"Sunday\"];\r\n    frappe.call({\r\n        method:\"frappe.client.get\",\r\n        args:{\r\n            doctype:\"Healthcare Practitioner\", \r\n            name: frappe.web_form.doc.practitioner,\r\n        },\r\n        freeze:true,\r\n        async:false,\r\n        callback:function(r){\r\n            frappe.web_form.fields_dict.department.set_value(r.message.department);\r\n            frappe.web_form.set_df_property(\"department\",\"read_only\",1);\r\n            frappe.web_form.fields_dict.duration.set_value(\"30\");\r\n            frappe.web_form.set_df_property(\"duration\",\"read_only\",1);\r\n            console.log(r.message.practitioner_schedules[0].schedule);\r\n            frappe.call({\r\n                method:\"frappe.client.get\",\r\n                args:{\r\n                    doctype:\"Practitioner Schedule\", \r\n                    name:r.message.practitioner_schedules[0].schedule,\r\n                },\r\n                \r\n                freeze:true,\r\n                async:false,\r\n                callback:function(r){\r\n                    var messages = r.message.time_slots;\r\n                    var newArray = messages.filter(function (el) {\r\n                        return el.day == daysOfWeek[(new Date()).getDay()];;\r\n                    });\r\n                    $('select[data-fieldname=\"appointment_time\"]').append(`<option val=\"\"></option>`);\r\n                    newArray.forEach(el => {\r\n                        $('select[data-fieldname=\"appointment_time\"]').append(`<option val=\"${el.from_time}\">${el.from_time}</option>`);\r\n                    });\r\n                    $('select[data-fieldname=\"appointment_time\"]').val(last_doc.appointment_time);\r\n                }\r\n            });\r\n        }\r\n    });\r\n});",
 "creation": "2020-07-12 21:57:45.638475",
 "currency": "PEN",
 "doc_type": "Patient Appointment",
 "docstatus": 0,
 "doctype": "Web Form",
 "idx": 0,
 "is_standard": 1,
 "login_required": 1,
 "max_attachment_size": 0,
 "modified": "2020-08-08 13:17:07.070260",
 "modified_by": "Administrator",
 "module": "Telemedicina",
 "name": "cita",
 "owner": "Administrator",
 "payment_button_label": "Buy Now",
 "published": 1,
 "route": "cita",
 "route_to_success_link": 0,
 "show_attachments": 0,
 "show_in_grid": 1,
 "show_sidebar": 1,
 "sidebar_items": [],
 "success_url": "/cita",
 "title": "Cita",
 "web_form_fields": [
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "inpatient_record",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Inpatient Record",
   "max_length": 0,
   "max_value": 0,
   "options": "Inpatient Record",
   "read_only": 1,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 1,
   "fieldname": "practitioner",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "M\u00e9dico",
   "max_length": 0,
   "max_value": 0,
   "options": "Healthcare Practitioner",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "",
   "fieldtype": "Section Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 1,
   "default": "",
   "fieldname": "patient",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Patient",
   "max_length": 0,
   "max_value": 0,
   "options": "Patient",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 1,
   "fieldname": "appointment_type",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Appointment Type",
   "max_length": 0,
   "max_value": 0,
   "options": "Appointment Type",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "appointment_date",
   "fieldtype": "Date",
   "hidden": 0,
   "label": "Date",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "description": "In Minutes",
   "fieldname": "duration",
   "fieldtype": "Int",
   "hidden": 0,
   "label": "Duration",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "column_break_1",
   "fieldtype": "Column Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "read_only": 1,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 1,
   "fieldname": "department",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Department",
   "max_length": 0,
   "max_value": 0,
   "options": "Medical Department",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "appointment_time",
   "fieldtype": "Select",
   "hidden": 0,
   "label": "Hora",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "appointment_datetime",
   "fieldtype": "Datetime",
   "hidden": 0,
   "label": "fechay hora",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "section_break_1",
   "fieldtype": "Section Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 1,
   "default": "Tarjeta de Cr\u00e9dito",
   "fieldname": "mode_of_payment",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Mode of Payment",
   "max_length": 0,
   "max_value": 0,
   "options": "Mode of Payment",
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "default": "0.00",
   "fieldname": "paid_amount",
   "fieldtype": "Currency",
   "hidden": 0,
   "label": "Paid Amount",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "notes",
   "fieldtype": "Small Text",
   "hidden": 0,
   "label": "Notes",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  }
 ]
}